<!doctype html><html><meta charset=utf-8><meta name=generator content="Hugo 0.76.5"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><link rel=icon type=image/png href=https://zyprex.github.io/zyprex.blog><link rel=stylesheet type=text/css href=https://zyprex.github.io/zyprex.blog/css/main.css><link rel=stylesheet type=text/css href=https://zyprex.github.io/zyprex.blog/css/syntax.css><title>Use ffmpeg Convert Videos@Zyprex's Blog</title><body><div class=fence><div style=height:2em;margin-top:1em;margin-bottom:1em;font-size:1.1em;overflow-x:scroll;overflow-y:hidden;white-space:nowrap><nav>|&emsp;<a href=/zyprex.blog/>HOME</a>&emsp;|&emsp;<a href=/zyprex.blog/tags/>TAGS</a>&emsp;|&emsp;<a href=/zyprex.blog/categories/>CATEGORIES</a>&emsp;|&emsp;<a href=/zyprex.blog/index.xml>RSS</a>&emsp;|&emsp;<a href=/zyprex.blog/search/>SEARCH</a>&emsp;|&emsp;<a href=/zyprex.blog/about/>ABOUT</a>&emsp;|</nav></div><div class=Hp><em class=T>Use ffmpeg Convert Videos</em><br><em>2023/08/25 Fri 12:52</em></div><nav class=toc><b onclick="nav_toc.hidden=!nav_toc.hidden;this.innerText=this.innerText=='+ catalogue'?'- catalogue':'+ catalogue'">+ catalogue</b><div id=nav_toc hidden><nav id=TableOfContents><ul><li><a href=#convert-m3u8-to-mp4-file>Convert m3u8 to mp4 file</a></li><li><a href=#split-mp4-file-to-m3u8-list>Split mp4 file to m3u8 list</a></li><li><a href=#merge-videos>Merge Videos</a></li><li><a href=#cut-video>Cut Video</a></li><li><a href=#compress-videos>Compress videos</a><ul><li><a href=#strategy-1-lower-resolution>Strategy 1. Lower Resolution</a></li><li><a href=#strategy-2-lower-frame-rate>Strategy 2. Lower Frame Rate</a></li><li><a href=#strategy-3-lower-bit-rate>Strategy 3. Lower Bit Rate</a></li><li><a href=#strategy-4-h264-to-h265>Strategy 4. H264 to H265</a></li><li><a href=#strategy-5-rise-crf>Strategy 5. Rise CRF</a></li></ul></li><li><a href=#read-more>Read More</a></li></ul></nav></div></nav><div id=C><h1 id=convert-m3u8-to-mp4-file>Convert m3u8 to mp4 file<sup><a class=h__anchor href=#convert-m3u8-to-mp4-file>¶</a></sup></h1><p>Use <code>index.m3u8</code> convert all TS files to a mp4 file.
(note: it can use web link as input)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>ffmpeg -i index.m3u8 -c copy -bsf:a aac_adtstoasc out.mp4
</code></pre></td></tr></table></div></div><h1 id=split-mp4-file-to-m3u8-list>Split mp4 file to m3u8 list<sup><a class=h__anchor href=#split-mp4-file-to-m3u8-list>¶</a></sup></h1><p>Split <code>a.mp4</code> to list of 240 seconds TS files in <code>out</code> folder.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>ffmpeg -i a.mp4 -vcodec copy -acodec copy -vbsf h264_mp4toannexb a.ts
ffmpeg -i a.ts -c copy -map <span class=m>0</span> -f segment -segment_list <span class=s2>&#34;out/index.m3u8&#34;</span> -segment_time <span class=m>240</span> <span class=s2>&#34;out/%%2d.ts&#34;</span>
</code></pre></td></tr></table></div></div><h1 id=merge-videos>Merge Videos<sup><a class=h__anchor href=#merge-videos>¶</a></sup></h1><p>A use case to merge videos by use a text file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1>#file_name: a.txt</span>
<span class=c1>#-----------</span>
<span class=c1>#file &#39;0.mp4&#39;</span>
<span class=c1>#file &#39;1.mp4&#39;</span>
<span class=c1>#file &#39;...&#39;</span>
<span class=c1>#-----------</span>
ffmpeg -f concat -safe <span class=m>0</span> -i a.txt -c copy a.mp4
</code></pre></td></tr></table></div></div><h1 id=cut-video>Cut Video<sup><a class=h__anchor href=#cut-video>¶</a></sup></h1><p>A use case to cut video 5 minutes start from 1 minutes.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=nv>start_time</span><span class=o>=</span>00:01:00
<span class=nv>end_time</span><span class=o>=</span>00:05:00
ffmpeg -threads <span class=m>16</span> -ss <span class=si>${</span><span class=nv>start_time</span><span class=si>}</span> -i <span class=si>${</span><span class=nv>input</span><span class=si>}</span> -to <span class=si>${</span><span class=nv>end_time</span><span class=si>}</span> -c:v copy -c:a copy <span class=si>${</span><span class=nv>output</span><span class=si>}</span>
</code></pre></td></tr></table></div></div><h1 id=compress-videos>Compress videos<sup><a class=h__anchor href=#compress-videos>¶</a></sup></h1><h2 id=strategy-1-lower-resolution>Strategy 1. Lower Resolution<sup><a class=h__anchor href=#strategy-1-lower-resolution>¶</a></sup></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># resolution (1920x1080/1280x720/640x360/426x240)</span>
ffmpeg -threads <span class=m>16</span> -i <span class=si>${</span><span class=nv>input</span><span class=si>}</span> -s 426x240 -c:a copy <span class=si>${</span><span class=nv>output</span><span class=si>}</span>
</code></pre></td></tr></table></div></div><p>Evalutation:</p><ul><li>lose: high</li><li>compress: high</li></ul><h2 id=strategy-2-lower-frame-rate>Strategy 2. Lower Frame Rate<sup><a class=h__anchor href=#strategy-2-lower-frame-rate>¶</a></sup></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>ffmpeg -threads <span class=m>16</span> -i <span class=si>${</span><span class=nv>input</span><span class=si>}</span> -r <span class=m>24</span> -c:a copy <span class=si>${</span><span class=nv>output</span><span class=si>}</span>
</code></pre></td></tr></table></div></div><p>Evalutation:</p><ul><li>lose: medium</li><li>compress: low</li></ul><h2 id=strategy-3-lower-bit-rate>Strategy 3. Lower Bit Rate<sup><a class=h__anchor href=#strategy-3-lower-bit-rate>¶</a></sup></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>ffmpeg -threads <span class=m>16</span> -i <span class=si>${</span><span class=nv>input</span><span class=si>}</span> -b:v 128k -c:a copy <span class=si>${</span><span class=nv>output</span><span class=si>}</span>
</code></pre></td></tr></table></div></div><p>Evalutation:</p><ul><li>lose: high</li><li>compress: low</li></ul><h2 id=strategy-4-h264-to-h265>Strategy 4. H264 to H265<sup><a class=h__anchor href=#strategy-4-h264-to-h265>¶</a></sup></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash>ffmpeg -threads <span class=m>16</span> -i <span class=si>${</span><span class=nv>input</span><span class=si>}</span> -c:v libx265 -c:a copy %<span class=o>{</span>output<span class=o>}</span>
</code></pre></td></tr></table></div></div><p>Evalutation:</p><ul><li>lose: low</li><li>compress: medium</li></ul><h2 id=strategy-5-rise-crf>Strategy 5. Rise CRF<sup><a class=h__anchor href=#strategy-5-rise-crf>¶</a></sup></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># crf 0-51</span>
ffmpeg -threads <span class=m>16</span> -i <span class=si>${</span><span class=nv>input</span><span class=si>}</span> -c:v libx264 -crf <span class=m>28</span> -preset veryslow -c:a copy %<span class=o>{</span>output<span class=o>}</span>
</code></pre></td></tr></table></div></div><p>Evalutation:</p><ul><li>lose: medium</li><li>compress: high</li></ul><h1 id=read-more>Read More<sup><a class=h__anchor href=#read-more>¶</a></sup></h1><ul><li><a class=md__link href=https://itsfoss.com/ffmpeg target=_blank rel=noopener>The Complete Guide for Using ffmpeg in Linux
↗</a></li></ul></div><div class=pager><br>▲ <a href=/zyprex.blog/2023/how-the-vim-save-my-life/>How the Vim Save My Life</a><br>▼ <a href=/zyprex.blog/2023/create-wlan-hotspot-on-linux/>Create WLAN Hotspot on Linux</a></div><footer style="text-align:right;margin:5rem .2rem .2rem"><div><section><a class=taxo href=https://zyprex.github.io/zyprex.blog/categories/ffmpeg/>@ffmpeg</a></section></div><div>&copy; 2020 - 2024</div><small>page 2023</small></footer></div><script defer type=application/javascript src=https://zyprex.github.io/zyprex.blog/js/norm.js></script></body></html>